p(g(_X),c).p([],b).p([_H|T],Y) :- p(T,Y).q(a).q(X) :- q(X). /* try with print(X) */q(a,a).q(X,f(Y)) :- q(X,Y).t(X) :- q(X),r(X).r(a).r(b) :- t(X).s(a,a).s(X,Y) :- q(X),s(X,Y),q(Y),print(f(X,Y)).lookup(X,[],X).lookup(Z,[H|T],X) :- lookup(Z,T,X).test(L1,L2,R) :- lookup(a,L1,X),lookup(X,L2,R).last([X],X).last([_,H|T],Y) :- last([H|T],Y).append([],L,L).append([H|X],Y,[H|Z]) :- append(X,Y,Z).applast(X,L,Y) :- append(L,[X],L2), last(L2,Y).store(X,Y,[],[val(X,Y)]).store(X,Y,[H|T],[H|RT]) :- store(X,Y,T,RT).lup(X,[val(X,Val)|_],Val).lup(X,[_|T],Val) :- lup(X,T,Val).test2(L,Res) :- store(x,a,L,L2),lup(x,L2,Res).test3(L,Res) :- store(x,a,L,L2),store(y,b,L2,L3),lup(x,L2,Res).